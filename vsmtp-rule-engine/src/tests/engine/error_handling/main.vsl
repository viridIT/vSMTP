import "errors" as err;

#{
    connect: [
        // `ctx.timestamp` isn't available in 'connect' stage.
        rule "error parsing" || err::generic_error(ctx),

        // previous rule should short circuit and return `next`.
        rule "trailing" || deny(),
    ],

    helo: [
        rule "user defined throw" || err::throw_error(),

        // previous rule should short circuit and return `next`.
        rule "trailing" || deny(),
    ],

    mail: [
        rule "deny and skip" || deny(),
        rule "skipped" || accept(),
    ]
}
