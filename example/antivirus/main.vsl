fn has_virus(services, ctx) {
    let result = services.run("clamscan", ctx);
    debug(`${result}`);

    if result.has_signal {
        // timed out
        return false;
    }

    result.has_code && result.code != 0
}

run_rules!(#{
    preq: [
        action "antivirus" || {
            if has_virus(services, ctx) {
                // quarantine and log and blacklist
            }
        }
    ]
})
