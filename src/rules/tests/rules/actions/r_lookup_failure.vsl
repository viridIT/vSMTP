rule helo "test_dnslookup_excluded_domain" #{
  // satan.org doesn't resolve to 0.0.0.0,
  // but if it did we could filter and deny the connexion.
  condition: || vsl.DNS_LOOKUP("satan.org"),
  on_success: vsl.DENY,
  on_failure: vsl.CONTINUE,
};

rule helo "test_dnslookup_mydomain_only" #{
  // we only accept connexions comming from mydomain.com.
  // mydomain.com doesn't resolve to 0.0.0.0, so we deny the connexion.
  condition: || vsl.DNS_LOOKUP("mydomain.com"),
  on_success: vsl.CONTINUE,
  on_failure: vsl.DENY,
};
