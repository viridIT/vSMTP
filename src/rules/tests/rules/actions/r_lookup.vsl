obj ip4 "google" "8.8.8.8";

rule helo "test_rlookup_google" #{
  // we suppose that the dns google address won't change in the futur
  // for this test.
  condition: || vsl.R_LOOKUP("8.8.8.8", 25) == "dns.google",
  on_success: vsl.CONTINUE,
  on_failure: vsl.DENY,
};

rule helo "test_rlookup_google_with_object" #{
  condition: || vsl.R_LOOKUP("google", 25) == "dns.google",
  on_success: vsl.CONTINUE,
  on_failure: vsl.DENY,
};

rule helo "test_rlookup_satan" #{
  condition: || vsl.R_LOOKUP(connect, 25) != "satan.org",
  on_success: vsl.ACCEPT,
  on_failure: vsl.DENY,
};