object ident "john" "johndoe";
object fqdn "viridit" "viridit.com";
object address "customer" "customer@company.com";

#{
  rcpt: [
    rule "test_ident" || if john in server.rcpt.local_parts { vsl::next() } else { vsl::deny() },
    rule "test_fqdn" || if viridit in server.rcpt.domains { vsl::next() } else { vsl::deny() },
    rule "test_addr" || if customer in server.rcpt { vsl::accept() } else { vsl::deny() },
  ],

  postq: [
    action "test_rewrite" || {
      server.rewrite_rcpt("johndoe@compagny.com", "johndoe@viridit.com");
      server.remove_rcpt("customer@company.com");
      server.add_rcpt("no-reply@viridit.com");
    },
  ]
}