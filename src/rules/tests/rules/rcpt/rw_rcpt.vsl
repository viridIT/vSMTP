obj regex "redirect" "^[a-z0-9.]+@viridit.[a-z0-9]+$";

rule preq "test_rw_rcpt" #{
  condition: || true,

  on_success: || {
    for r in rcpts {
      rcpt = r;
      if vsl.IS_RCPT("redirect") {
        // quietly replacing the recipient's domain.
        vsl.RW_RCPT(rcpt, `${rcpt.local_part}@viridit.fr`);
      }
    }
    vsl.CONTINUE()
  },
};