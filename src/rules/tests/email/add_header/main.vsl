import "add_header" as add;

#{
    mail: [
        rule "adding header when no data" || {
            add::add_header_failure(
                ctx,
                "X-My-Header",
                "my value", "failed to add header 'X-My-Header': the body has not been received yet."
            )
        },

        rule "trailing" || vsl::accept(),
    ],

    preq: [
        rule "adding header to raw email" || add::add_header_success(ctx, "X-New-Header", "value of header"),

        rule "trailing" || vsl::accept(),
    ],

    postq: [
        rule "adding header to parsed email" || add::add_header_success(ctx, "X-New-Header", "value of header"),

        rule "trailing" || vsl::accept(),
    ],
}