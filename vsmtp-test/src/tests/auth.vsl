#{
    connect: [
        rule "ok" || sys::accept()
    ],
    authenticate: [
        rule "auth hardcoded" || {
            let db = #{
                "hello": "world",
                "héllo": "wÖrld"
            };

            if ctx.is_authenticated {
                return sys::deny();
            }

            switch ctx.auth.type {
                "Verify" => {
                    if db[ctx.auth.authid] == ctx.auth.authpass {
                        sys::accept()
                    } else {
                        sys::deny()
                    }
                },
                "Query" => {
                    sys::info(db[ctx.auth.authid])
                }
            }
        }
    ]
}
