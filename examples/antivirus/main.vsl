fn has_virus(services, ctx) {
    let result = services.run("clamscan", ctx);
    vsl::log("debug", `${result}`);

    if result.has_signal {
        // timed out
        return false;
    }

    result.has_code && result.code != 0
}

#{
    preq: [
        action "antivirus" || {
            if has_virus(services, ctx) {
                // quarantine, log and blacklist.
            }
        }
    ]
}
